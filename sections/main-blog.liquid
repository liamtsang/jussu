{{ 'section-main-blog.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

{%- paginate blog.articles by 6 -%}
  <div class="main-blog page-width section-{{ section.id }}-padding">
    {%- if blog.all_tags.size > 0 -%}
      <div class="blog-filter">
        <span class="blog-filter-label caption-large">Category</span>
        <div class="blog-filter-tags">
          <a href="{{ blog.url }}" class="blog-filter-tag{% unless current_tags %} blog-filter-tag--active{% endunless %}">
            <span class="blog-filter-tag-inner">All</span>
          </a>
          {%- for tag in blog.all_tags -%}
            <a href="{{ blog.url }}/tagged/{{ tag | handleize }}" class="blog-filter-tag{% if current_tags contains tag %} blog-filter-tag--active{% endif %}">
              <span class="blog-filter-tag-inner">{{ tag }}</span>
            </a>
          {%- endfor -%}
        </div>
      </div>
    {%- endif -%}

    <div class="blog-articles">
      {%- for article in blog.articles -%}
        <div class="blog-article-row">
          <span class="blog-article-date">
            {%- assign d = article.published_at | date: '%m%d%Y' -%}
            {{ d }}
          </span>
          <a href="{{ article.url }}" class="blog-article-media">
            {%- if article.image -%}
              <div class="blog-article-thumb">
                <img
                  srcset="
                    {%- if article.image.src.width >= 360 -%}{{ article.image.src | image_url: width: 360 }} 360w,{%- endif -%}
                    {%- if article.image.src.width >= 533 -%}{{ article.image.src | image_url: width: 533 }} 533w,{%- endif -%}
                    {%- if article.image.src.width >= 720 -%}{{ article.image.src | image_url: width: 720 }} 720w,{%- endif -%}
                    {%- if article.image.src.width >= 1000 -%}{{ article.image.src | image_url: width: 1000 }} 1000w,{%- endif -%}
                    {{ article.image.src | image_url }} {{ article.image.src.width }}w
                  "
                  src="{{ article.image.src | image_url: width: 720 }}"
                  sizes="(min-width: 750px) 600px, 80vw"
                  alt="{{ article.image.src.alt | escape }}"
                  loading="lazy"
                  width="{{ article.image.width }}"
                  height="{{ article.image.height }}"
                >
              </div>
            {%- endif -%}
            <div class="blog-article-description">
              <p>
                {%- if article.excerpt.size > 0 -%}
                  {{ article.excerpt | strip_html }}
                {%- else -%}
                  {{ article.content | strip_html | truncatewords: 50 }}
                {%- endif -%}
              </p>
            </div>
          </a>
        </div>
      {%- endfor -%}
    </div>

    {%- if paginate.pages > 1 -%}
      {%- render 'pagination', paginate: paginate -%}
    {%- endif -%}
  </div>
{%- endpaginate -%}

{% schema %}
{
  "name": "t:sections.main-blog.name",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
